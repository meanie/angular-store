/**
 * meanie-angular-store - v1.0.0 - 10-1-2016
 * https://github.com/meanie/angular-store
 *
 * Copyright (c) 2016 Adam Buczynski <me@adambuczynski.com>
 * License: MIT
 */
"use strict";!function(e,t,o){t.module("Store.Service",["Store.BaseStore.Service","Store.CollectionStore.Service","Store.InstanceStore.Service"]).provider("$store",function(){this.defaults={model:"",methods:null,service:"$collectionStore"},this.collections={},this.registerStore=function(e,t){return e&&(this.collections[e]=t||{}),this},this.$get=["$log","$injector",function(e,o){var n=function(e){return this[e]};return t.forEach(this.collections,function(r,i){if(r=t.extend({},this.defaults,r),!r.service||!o.has(r.service))return e.error("Unknown service",r.service,"specified for",i,"store");if(!r.model||!o.has(r.model))return e.error("Unknown model specified for",i,"store:",r.model);var s=o.get(r.service),c=new s(i,r);n[i]&&e.warn("Store",i,"is being overwritten."),n[i]=c},this),n}]})}(window,window.angular);var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};!function(e,t,o){t.module("Store.BaseStore.Service",[]).factory("$baseStore",["$q","$log","$injector",function(e,o,n){function r(e,t,o){return e instanceof t?e:o&&"object"===("undefined"==typeof e?"undefined":_typeof(e))?new t(e):null}function i(e,t){this.name=e,this.config=t;var o=null;Object.defineProperty(this,"model",{get:function(){return o=o||n.get(t.model)}})}return i.prototype.validateIsModel=function(n,i){var s=this;if(t.isArray(n)){var c=n.map(function(e){return r(e,s.model,i)}).filter(function(e){return!!e});return e.resolve(c)}var l=r(n,this.model,i);return null!==l?e.resolve(l):(o.warn("Invalid object passed to",this.name,"store as model:",n),e.reject("Invalid model"))},i}])}(window,window.angular),function(e,t,o){t.module("Store.CollectionStore.Service",["Store.BaseStore.Service"]).factory("$collectionStore",["$q","$baseStore",function(e,o){function n(e,t){o.call(this,e,t),this.collection=new Map,this.loaded=!1}return t.extend(n.prototype,o.prototype),n.prototype.query=function(t,o){var n=this;return this.loaded&&!o?e.resolve(Array.from(this.collection.values())):this.model.query(t).then(function(e){return e.forEach(function(e){return n.add(e)}),n.loaded=!0,e})},n.prototype.clear=function(){return this.collection.clear(),e.resolve()},n.prototype.findById=function(t){var o=this;return this.collection.has(t)?e.resolve(this.collection.get(t)):this.model.findById(t).then(function(e){return o.add(e)})},n.prototype.save=function(e,t){var o=this;return this.validateIsModel(e,!0).then(function(e){return e.save(t)}).then(function(e){return o.add(e)})},n.prototype["delete"]=function(e){var t=this;return this.validateIsModel(e).then(function(e){return e["delete"]()}).then(function(e){return t.remove(e)})},n.prototype.load=function(e){var t=this;return e=e||[],this.validateIsModel(e,!0).then(function(e){return t.add(e)})["finally"](function(){return t.isLoaded=!0})},n.prototype.add=function(o){var n=this;return t.isArray(o)?o.forEach(function(e){return n.collection.set(e.id,e)}):this.collection.set(o.id,o),e.resolve(o)},n.prototype.remove=function(o){var n=this;return t.isArray(o)?o.forEach(function(e){return n.collection["delete"](e.id)}):this.collection["delete"](o.id),e.resolve(o)},n}])}(window,window.angular),function(e,t,o){t.module("Store.InstanceStore.Service",["Store.BaseStore.Service"]).factory("$instanceStore",["$q","$baseStore",function(e,o){function n(e,t){o.call(this,e,t),this.instance=null,this.promise=null}return t.extend(n.prototype,o.prototype),n.prototype.get=function(t){var o=this;return this.instance&&!t?e.resolve(this.instance):this.promise?this.promise:(this.promise=this.model.get().then(function(e){return o.instance=e})["finally"](function(){return o.promise=null}),this.promise)},n.prototype.set=function(t){return e.resolve(this.instance=t)},n.prototype.clear=function(){return this.instance=null,e.resolve()},n.prototype.save=function(e,t){return this.validateIsModel(e,!0).then(function(e){return e.save(t)})},n.prototype["delete"]=function(e){return this.validateIsModel(e).then(function(e){return e["delete"]()})},n}])}(window,window.angular);
//# sourceMappingURL=meanie-angular-store.min.js.map

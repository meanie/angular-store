/**
 * meanie-angular-store - v1.0.1 - 10-1-2016
 * https://github.com/meanie/angular-store
 *
 * Copyright (c) 2016 Adam Buczynski <me@adambuczynski.com>
 * License: MIT
 */
"use strict";!function(e,t,n){t.module("Store.Service",["Store.BaseStore.Service","Store.CollectionStore.Service","Store.InstanceStore.Service"]).provider("$store",function(){this.defaults={model:"",methods:null,service:"$collectionStore"},this.collections={},this.registerStore=function(e,t){return e&&(this.collections[e]=t||{}),this},this.$get=["$log","$injector",function(e,n){var o=function(e){return this[e]};return t.forEach(this.collections,function(r,i){if(r=t.extend({},this.defaults,r),!r.service||!n.has(r.service))return e.error("Unknown service",r.service,"specified for",i,"store");if(!r.model||!n.has(r.model))return e.error("Unknown model specified for",i,"store:",r.model);var s=n.get(r.service),c=new s(i,r);o[i]&&e.warn("Store",i,"is being overwritten."),o[i]=c},this),o}]})}(window,window.angular);var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};!function(e,t,n){t.module("Store.BaseStore.Service",[]).factory("$baseStore",["$q","$log","$injector",function(e,n,o){function r(e,t,n){return e instanceof t?e:n&&"object"===("undefined"==typeof e?"undefined":_typeof(e))?new t(e):null}function i(e,t){this.name=e,this.config=t;var n=null;Object.defineProperty(this,"model",{get:function(){return n=n||o.get(t.model)}})}return i.prototype.validateIsModel=function(o,i){var s=this;if(t.isArray(o)){var c=o.map(function(e){return r(e,s.model,i)}).filter(function(e){return!!e});return e.resolve(c)}var l=r(o,this.model,i);return null!==l?e.resolve(l):(n.warn("Invalid object passed to",this.name,"store as model:",o),e.reject("Invalid model"))},i}])}(window,window.angular),function(e,t,n){t.module("Store.CollectionStore.Service",["Store.BaseStore.Service"]).factory("$collectionStore",["$q","$baseStore",function(e,n){function o(e,t){n.call(this,e,t),this.collection=new Map,this.loaded=!1}return t.extend(o.prototype,n.prototype),o.prototype.query=function(t,n){var o=this;return!this.loaded||t||n?this.model.query(t).then(function(e){return e.forEach(function(e){return o.add(e)}),o.loaded=!0,e}):e.resolve(Array.from(this.collection.values()))},o.prototype.clear=function(){return this.collection.clear(),e.resolve()},o.prototype.findById=function(t){var n=this;return this.collection.has(t)?e.resolve(this.collection.get(t)):this.model.findById(t).then(function(e){return n.add(e)})},o.prototype.save=function(e,t){var n=this;return this.validateIsModel(e,!0).then(function(e){return e.save(t)}).then(function(e){return n.add(e)})},o.prototype["delete"]=function(e){var t=this;return this.validateIsModel(e).then(function(e){return e["delete"]()}).then(function(e){return t.remove(e)})},o.prototype.load=function(e){var t=this;return e=e||[],this.validateIsModel(e,!0).then(function(e){return t.add(e)})["finally"](function(){return t.isLoaded=!0})},o.prototype.add=function(n){var o=this;return t.isArray(n)?n.forEach(function(e){return o.collection.set(e.id,e)}):this.collection.set(n.id,n),e.resolve(n)},o.prototype.remove=function(n){var o=this;return t.isArray(n)?n.forEach(function(e){return o.collection["delete"](e.id)}):this.collection["delete"](n.id),e.resolve(n)},o}])}(window,window.angular),function(e,t,n){t.module("Store.InstanceStore.Service",["Store.BaseStore.Service"]).factory("$instanceStore",["$q","$baseStore",function(e,n){function o(e,t){n.call(this,e,t),this.instance=null,this.promise=null}return t.extend(o.prototype,n.prototype),o.prototype.get=function(t){var n=this;return this.instance&&!t?e.resolve(this.instance):this.promise?this.promise:(this.promise=this.model.get().then(function(e){return n.instance=e})["finally"](function(){return n.promise=null}),this.promise)},o.prototype.set=function(e){var t=this;return this.validateIsModel(e,!0).then(function(e){return t.instance=e})},o.prototype.clear=function(){return this.instance=null,e.resolve()},o.prototype.save=function(e,t){return this.validateIsModel(e,!0).then(function(e){return e.save(t)})},o}])}(window,window.angular);
//# sourceMappingURL=meanie-angular-store.min.js.map

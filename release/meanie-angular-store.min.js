/**
 * meanie-angular-store - v1.0.6 - 12-1-2016
 * https://github.com/meanie/angular-store
 *
 * Copyright (c) 2016 Adam Buczynski <me@adambuczynski.com>
 * License: MIT
 */
"use strict";!function(e,t,o){t.module("Store.Service",["Store.BaseStore.Service","Store.CollectionStore.Service","Store.InstanceStore.Service"]).provider("$store",function(){this.defaults={model:"",methods:null,service:"$collectionStore",verbose:!1},this.collections={},this.setVerbose=function(e){return this.defaults.verbose=!!e,this},this.registerStore=function(e,t){return e&&(this.collections[e]=t||{}),this},this.$get=["$log","$injector",function(e,o){var n=function(e){return this[e]};return t.forEach(this.collections,function(r,i){if(r=t.extend({},this.defaults,r),r.verbose&&e.info("Setting up",i,"store with config",r),!r.service||!o.has(r.service))return e.error("Unknown service",r.service,"specified for",i,"store");if(!r.model||!o.has(r.model))return e.error("Unknown model specified for",i,"store:",r.model);var s=o.get(r.service),l=new s(i,r);n[i]&&e.warn("Store",i,"is being overwritten."),n[i]=l},this),n}]})}(window,window.angular);var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};!function(e,t,o){t.module("Store.BaseStore.Service",[]).factory("$baseStore",["$q","$log","$injector",function(e,o,n){function r(e,t,o){return e instanceof t?e:o&&"object"===("undefined"==typeof e?"undefined":_typeof(e))?new t(e):null}function i(e,t){this.name=e,this.config=t;var r=null;Object.defineProperty(this,"model",{get:function(){return r=r||n.get(t.model),t.verbose&&o.info("Resolved",t.model,"model as",r),r}})}return i.prototype.validateIsModel=function(n,i){var s=this;if(t.isArray(n)){var l=n.map(function(e){return r(e,s.model,i)}).filter(function(e){return!!e});return e.resolve(l)}var c=r(n,this.model,i);return null!==c?e.resolve(c):(o.warn("Invalid object passed to",this.name,"store as model:",n),e.reject("Invalid model"))},i}])}(window,window.angular),function(e,t,o){t.module("Store.CollectionStore.Service",["Store.BaseStore.Service"]).factory("$collectionStore",["$q","$log","$baseStore",function(e,o,n){function r(e,t){n.call(this,e,t),this.collection=new Map,this.isLoaded=!1}return t.extend(r.prototype,n.prototype),r.prototype.query=function(n,r){var i=this;return!this.isLoaded||n||r?t.isFunction(this.model.query)?this.model.query(n).then(function(e){return e.forEach(function(e){return i.add(e)}),i.isLoaded=!0,e}):(o.warn("No query method present on model for",this.name,"store"),e.resolve([])):e.resolve(Array.from(this.collection.values()))},r.prototype.clear=function(){return this.collection.clear(),e.resolve()},r.prototype.findById=function(n){var r=this;return this.collection.has(n)?e.resolve(this.collection.get(n)):t.isFunction(this.model.findById)?this.model.findById(n).then(function(e){return r.add(e)}):(o.warn("No findById method present on model for",this.name,"store"),e.resolve([]))},r.prototype.save=function(e,t){var o=this;return this.validateIsModel(e,!0).then(function(e){return e.save(t)}).then(function(e){return o.add(e)})},r.prototype["delete"]=function(e){var t=this;return this.validateIsModel(e).then(function(e){return e["delete"]()}).then(function(e){return t.remove(e)})},r.prototype.load=function(e){var t=this;return e=e||[],this.validateIsModel(e,!0).then(function(e){return t.add(e)})["finally"](function(){t.isLoaded=!0})},r.prototype.add=function(o){var n=this;return t.isArray(o)?o.forEach(function(e){return n.collection.set(e.id,e)}):this.collection.set(o.id,o),e.resolve(o)},r.prototype.remove=function(o){var n=this;return t.isArray(o)?o.forEach(function(e){return n.collection["delete"](e.id)}):this.collection["delete"](o.id),e.resolve(o)},r}])}(window,window.angular),function(e,t,o){t.module("Store.InstanceStore.Service",["Store.BaseStore.Service"]).factory("$instanceStore",["$q","$log","$baseStore",function(e,o,n){function r(e,t){n.call(this,e,t),this.instance=null,this.promise=null}return t.extend(r.prototype,n.prototype),r.prototype.get=function(n){var r=this;return this.instance&&!n?e.resolve(this.instance):this.promise?this.promise:t.isFunction(this.model.get)?(this.promise=this.model.get().then(function(e){return r.instance=e})["finally"](function(){r.promise=null}),this.promise):(o.warn("No get method present on model for",this.name,"store"),e.resolve([]))},r.prototype.set=function(e){var t=this;return this.validateIsModel(e,!0).then(function(e){return t.instance=e})},r.prototype.clear=function(){return this.instance=null,e.resolve()},r.prototype.save=function(e,t){return this.validateIsModel(e,!0).then(function(e){return e.save(t)})},r}])}(window,window.angular);
//# sourceMappingURL=meanie-angular-store.min.js.map
